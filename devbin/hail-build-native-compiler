#!/usr/bin/env bash

cd $HAIL_NATIVE_COMPILER_DIRECTORY
rm -rf $HAIL_NATIVE_COMPILER_BUILD_DIRECTORY
mkdir -p $HAIL_NATIVE_COMPILER_BUILD_DIRECTORY
cd $HAIL_NATIVE_COMPILER_BUILD_DIRECTORY
cmake .. -G Ninja \
  -DCMAKE_BUILD_TYPE=RelWithDebInfo \
  -DCMAKE_C_COMPILER=$LLVM_BUILD_BIN_DIRECTORY/clang \
  -DCMAKE_CXX_COMPILER=$LLVM_BUILD_BIN_DIRECTORY/clang++ \
  -DCMAKE_EXPORT_COMPILE_COMMANDS=1 \
  -DLLVM_BUILD_BINARY_DIR=$LLVM_BUILD_BIN_DIRECTORY \
  -DMLIR_DIR=$LLVM_BUILD_DIRECTORY/lib/cmake/mlir
ninja
cd -
